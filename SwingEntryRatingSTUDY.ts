# SWINGENTRYRATING
# WGRIFFITH2 (C) 2014

DECLARE LOWER;

INPUT KPERIOD = 14;
INPUT DPERIOD = 3;
INPUT MACD_FAST = 5;
INPUT MACD_SLOW = 35;
INPUT MACD_LEN = 5;

# STOCHASTICSLOW
DEF FASTLINE = STOCHASTICSLOW("D PERIOD" = DPERIOD, "K PERIOD" = KPERIOD);
DEF SLOWLINE = STOCHASTICSLOW("D PERIOD" = DPERIOD, "K PERIOD" = KPERIOD).SLOWD;

# MACD
DEF MACD = MACDHISTOGRAM("FAST LENGTH" = MACD_FAST, "SLOW LENGTH" = MACD_SLOW, "MACD LENGTH" = MACD_LEN);

# TEST
DEF GREENPRICE = FASTLINE >= SLOWLINE AND MACD >= 0.00;
DEF REDPRICE = FASTLINE < SLOWLINE AND MACD < 0.00;

PLOT RATING =

IF
!REDPRICE
AND CLOSE > HIGHEST(DATA = HIGH, LENGTH = 2)[1]
AND LOWEST(FASTLINE,3) <= 20
THEN FASTLINE-FASTLINE[1]

ELSE IF
!GREENPRICE
AND CLOSE < LOWEST(DATA = LOW, LENGTH = 2)[1]
AND HIGHEST(FASTLINE,3) >= 80
THEN FASTLINE-FASTLINE[1]

ELSE 0;